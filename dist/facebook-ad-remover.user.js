// ==UserScript==
// @name        Facebook advertisements remover
// @version     1.2.1
// @author      Hung Dinh
// @description Remove advertisements on facebook web
// @homepage    https://github.com/dinhhung2910/our-userscripts#readme
// @supportURL  https://github.com/dinhhung2910/our-userscripts/pulls
// @match       https://www.facebook.com/**
// @namespace   Script
// @updateURL   https://github.com/dinhhung2910/our-userscripts/raw/main/dist/facebook-ad-remover.user.js
// @source      https://github.com/dinhhung2910/our-userscripts/blob/main/dist/facebook-ad-remover.user.js
// @grant       GM_getValue
// @grant       GM_setValue
// @grant       GM_deleteValue
// @grant       GM_listValues
// @grant       GM_notification
// @grant       GM_xmlhttpRequest
// @grant       GM_addValueChangeListener
// @grant       GM_removeValueChangeListener
// @grant       GM_log
// ==/UserScript==

(()=>{"use strict";var e={990:(e,t,o)=>{function n(e){const t=document.getElementsByTagName("head")[0],o=document.createElement("link");t&&(o.type="text/css",o.rel="stylesheet",o.href=e,t.appendChild(o))}o.r(t),o.d(t,{addExternalStyle:()=>n,observeDOM:()=>r,getSnapshotElmByContent:()=>l,checkContainSelectors:()=>s,removeDOM:()=>a,hideDOM:()=>c});const r=(e,t,o)=>{const n={attributes:!1,childList:!1,subtree:!1,...t},r=new MutationObserver(o);return r.observe(e,n),()=>r.disconnect()},l=e=>{const t=document.evaluate(`//b[contains(., '${e}')]`,document,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);return t&&t.snapshotLength?t.snapshotItem(0):null},s=(e,t)=>{if(!e)return!1;let o=!1;return t.forEach((t=>{((e,t)=>!!e.querySelector(t))(e,t)&&(o=!0)})),o},a=e=>{try{e.parentElement.removeChild(e)}catch(e){console.error(e)}},c=e=>{try{e.style.display="none",e.classList.add("hided")}catch(e){console.error(e)}}},758:(e,t,o)=>{o.r(t),o.d(t,{AD_LABELS:()=>n,RIGHT_PANEL_SELECTOR:()=>r,RIGHT_PANEL_ADS_ARIA:()=>l,FEED_SELECTOR:()=>s,ARTICLES_SELECTOR:()=>a,INTERVAL_TIME_RE_EVALUATE_ADS:()=>c,INTERVAL_TIME_REMOVE_EXISTED_ADS:()=>i});const n=["Được tài trợ"],r='[data-pagelet="RightRail"]',l=['[aria-label="Liên kết của nhà quảng cáo"]'],s='[role="feed"]',a="[data-pagelet]:not(.hided)",c=3e4,i=2e3}},t={};function o(n){var r=t[n];if(void 0!==r)return r.exports;var l=t[n]={exports:{}};return e[n](l,l.exports,o),l.exports}o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e=o(990),t=o(758);const n=GM_setValue,r=GM_getValue,l=GM_deleteValue,s=GM_listValues,a=(e,t)=>{GM_addValueChangeListener(e,((e,o,n,r)=>t(n,r,o)))},c=(e,t,o)=>{n(e,o(r(e,t)))},i={get:r,set:n,del:l,list:s,onChange:a,update:c,val:e=>({set:n.bind(null,e),get:r.bind(null,e),del:l.bind(null,e),update:c.bind(null,e),onChange:a.bind(null,e)})},d=(o=t.INTERVAL_TIME_RE_EVALUATE_ADS)=>(t.AD_LABELS.forEach((t=>{const o=(0,e.getSnapshotElmByContent)(t);if(o){const e="."+o.className.split(" ").join(".");n("adSelector",e),console.info("Updated ad selector")}})),r("adSelector")?setTimeout((()=>{d()}),o):setTimeout((()=>{d()}),500)),E=d,u={attributes:!1,childList:!0,subtree:!1},_=function(t,o){for(const o of t)"childList"===o.type&&o.addedNodes.forEach((t=>{S(t)&&(console.log("removed incoming ad"),(0,e.hideDOM)(t))}))},S=e=>{let o=!1;const n=i.get("adSelector");return e.querySelectorAll(n).forEach((e=>{"string"==typeof e.innerText&&t.AD_LABELS.forEach((t=>{e.innerText.includes(t)&&(o=!0)}))})),o},h=o=>{o?o.querySelectorAll(t.ARTICLES_SELECTOR).forEach((t=>{S(t)&&(console.log("removed remain ad"),(0,e.hideDOM)(t))})):setTimeout((()=>{const e=document.querySelector(t.FEED_SELECTOR);h(e)}))},T=o=>{o?(0,e.observeDOM)(o,u,_):setTimeout((()=>{const e=document.querySelector(t.FEED_SELECTOR);T(e)}))},{checkContainSelectors:A,removeDOM:m}=o(990),{RIGHT_PANEL_SELECTOR:L,RIGHT_PANEL_ADS_ARIA:p,AD_LABELS:R}=o(758),f=()=>{(()=>{const e=document.querySelector(L);e&&setTimeout((()=>{let t=null;try{t=e.firstElementChild.firstElementChild}catch(e){}if(A(t,p))m(t),console.log("Removed right panel ads");else{let e=!1;const o=t.innerText;R.forEach((t=>{o.includes(t)&&(e=!0)})),e&&m(t)}}),0)})(),h()};E(),setInterval(f,t.INTERVAL_TIME_REMOVE_EXISTED_ADS),T()})()})();