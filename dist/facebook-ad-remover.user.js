// ==UserScript==
// @name Facebook advertisements remover
// @description Remove advertisements on facebook web
// @version 1.5.6
// @author Hung Dinh
// @supportURL https://github.com/dinhhung2910/our-userscripts/pulls
// @match https://www.facebook.com/**
// @grant GM_getValue
// @grant GM_setValue
// @grant GM_deleteValue
// @grant GM_listValues
// @grant GM_notification
// @grant GM_xmlhttpRequest
// @grant GM_addValueChangeListener
// @grant GM_removeValueChangeListener
// @grant GM_log
// @namespace Script
// @source https://github.com/dinhhung2910/our-userscripts/blob/main/dist/facebook-ad-remover.user.js
// @updateURL https://github.com/dinhhung2910/our-userscripts/raw/main/dist/facebook-ad-remover.user.js
// ==/UserScript==

(()=>{"use strict";var e={608:(e,t,n)=>{n.r(t),n.d(t,{AD_LABELS:()=>l,AD_SELECTORS:()=>r,ARTICLES_SELECTOR:()=>a,DEFAULT_AD_SELECTOR:()=>T,FEED_HEADING_CONTENT:()=>c,FEED_HEADING_SELECTOR:()=>s,IGNORED_ARTICLE_LABELS:()=>d,INGORED_ARTICLE_CATEGORIES:()=>i,INTERVAL_TIME_REMOVE_EXISTED_ADS:()=>_,INTERVAL_TIME_RE_EVALUATE_ADS:()=>u,RIGHT_PANEL_ADS_HEADING_CONTENT:()=>E,RIGHT_PANEL_SELECTOR:()=>o,STORE_KEY:()=>S});const l=["Được tài trợ","Gợi ý cho bạn","Sponsored","Suggested for You","Reels và video ngắn"],r=['[href^="/ads/about"]','[href^="/reel/"]'],o="div[role=complementary]",E="Được tài trợ",s="h3",c="Bài viết trên Bảng tin",a=":scope>div:not(.checked)",i=["SPONSORED","ENGAGEMENT","SHOWCASE","FB_SHORTS"],d=[80],u=3e4,_=2e3,S="adSelector",T=["[aria-label=Sponsored]","a[role=link][target=_blank]"]},713:(e,t,n)=>{function l(e){const t=document.getElementsByTagName("head")[0],n=document.createElement("link");t&&(n.type="text/css",n.rel="stylesheet",n.href=e,t.appendChild(n))}n.r(t),n.d(t,{addExternalStyle:()=>l,checkContainSelectors:()=>E,getSnapshotElmByContent:()=>o,hideDOM:()=>c,observeDOM:()=>r,removeDOM:()=>s});const r=(e,t,n)=>{const l={attributes:!1,childList:!1,subtree:!1,...t},r=new MutationObserver(n);return r.observe(e,l),()=>r.disconnect()},o=e=>{const t=["b","span"];let n=null;for(let l=0;l<t.length;l++){const r=t[l];if(n&&n.snapshotLength)break;n=document.evaluate(`//${r}[contains(., '${e}')]`,document,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null)}return n&&n.snapshotLength?n.snapshotItem(0):null},E=(e,t)=>{if(!e)return!1;let n=!1;return t.forEach((t=>{((e,t)=>!!e.querySelector(t))(e,t)&&(n=!0)})),n},s=e=>{try{e.parentElement.removeChild(e)}catch(e){console.error(e)}},c=e=>{try{e.style.display="none",e.classList.add("hided")}catch(e){console.error(e)}}}},t={};function n(l){var r=t[l];if(void 0!==r)return r.exports;var o=t[l]={exports:{}};return e[l](o,o.exports,n),o.exports}n.d=(e,t)=>{for(var l in t)n.o(t,l)&&!n.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};const l=GM_setValue,r=GM_getValue,o=GM_deleteValue,E=GM_listValues,s=(e,t)=>{GM_addValueChangeListener(e,((e,n,l,r)=>t(l,r,n)))},c=(e,t,n)=>{l(e,n(r(e,t)))},a={get:r,set:l,del:o,list:E,onChange:s,update:c,val:e=>({set:l.bind(null,e),get:r.bind(null,e),del:o.bind(null,e),update:c.bind(null,e),onChange:s.bind(null,e)})};var i=n(608),d=n(713);const u={attributes:!1,childList:!0,subtree:!1},_=function(e,t){for(const t of e)"childList"===t.type&&t.addedNodes.forEach((e=>{S(e)&&(console.log("removed incoming ad"),(0,d.hideDOM)(e))}))},S=e=>{if(!e)return!1;let t=!1;if(!t){const n=e.querySelector("h4");n&&n.innerText.includes("Theo dõi")&&(t=!0)}if(!t){const n=(e=>{const t=e.querySelector("h4");if(!t)return null;let n=t.parentElement;for(;n&&!(n.querySelectorAll("a").length>1);)n=n.parentElement;if(!n)return null;const l=n.querySelectorAll("a"),r=l[l.length-1],o=Object.keys(r).find((e=>e.includes("reactProp")));if(!o)return null;let E=null;try{E=r[o].children.props.children.props.children.props.props.text.$2}catch(e){}return E})(e);n&&"Được tài trợ"===n&&(t=!0)}return e.classList.add("checked"),t},T=e=>{e?e.querySelectorAll(i.ARTICLES_SELECTOR).forEach((e=>{S(e)&&(console.log("removed remain ad"),(0,d.hideDOM)(e))})):setTimeout((()=>{const e=document.querySelectorAll(i.FEED_HEADING_SELECTOR);let t=null;for(let n of e)n.innerText==i.FEED_HEADING_CONTENT&&(t=t=n.parentElement.lastElementChild);T(t)}))},h=e=>{e?(0,d.observeDOM)(e,u,_):setTimeout((()=>{const e=document.querySelectorAll(i.FEED_HEADING_SELECTOR);let t=null;for(let n of e)n.innerText==i.FEED_HEADING_CONTENT&&(t=n.parentElement.lastElementChild);h(t)}),500)},{removeDOM:A}=n(713),{RIGHT_PANEL_SELECTOR:p,RIGHT_PANEL_ADS_HEADING_CONTENT:O}=n(608),D=()=>{(()=>{const e=document.querySelector(p);if(e){const t=e.querySelectorAll("h3");let n=null;for(const e of t)e.innerText==O&&(n=e);let l=n;if(n)for(;l&&!(l.parentElement&&l.parentElement.querySelectorAll("h3").length>1);)l=l.parentElement;l&&(console.log("Remove right panel ADs"),A(l))}})(),T()};a.set(i.STORE_KEY,i.DEFAULT_AD_SELECTOR),setInterval(D,i.INTERVAL_TIME_REMOVE_EXISTED_ADS),h()})();