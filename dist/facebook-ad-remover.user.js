// ==UserScript==
// @name Facebook advertisements remover
// @description Remove advertisements on facebook web
// @version 1.5.5
// @author Hung Dinh
// @supportURL https://github.com/dinhhung2910/our-userscripts/pulls
// @match https://www.facebook.com/**
// @grant GM_getValue
// @grant GM_setValue
// @grant GM_deleteValue
// @grant GM_listValues
// @grant GM_notification
// @grant GM_xmlhttpRequest
// @grant GM_addValueChangeListener
// @grant GM_removeValueChangeListener
// @grant GM_log
// @namespace Script
// @source https://github.com/dinhhung2910/our-userscripts/blob/main/dist/facebook-ad-remover.user.js
// @updateURL https://github.com/dinhhung2910/our-userscripts/raw/main/dist/facebook-ad-remover.user.js
// ==/UserScript==

(()=>{"use strict";var e={608:(e,t,n)=>{n.r(t),n.d(t,{AD_LABELS:()=>r,AD_SELECTORS:()=>l,ARTICLES_SELECTOR:()=>i,DEFAULT_AD_SELECTOR:()=>S,FEED_HEADING_CONTENT:()=>c,FEED_HEADING_SELECTOR:()=>s,IGNORED_ARTICLE_LABELS:()=>d,INGORED_ARTICLE_CATEGORIES:()=>a,INTERVAL_TIME_REMOVE_EXISTED_ADS:()=>_,INTERVAL_TIME_RE_EVALUATE_ADS:()=>u,RIGHT_PANEL_ADS_HEADING_CONTENT:()=>E,RIGHT_PANEL_SELECTOR:()=>o,STORE_KEY:()=>T});const r=["Được tài trợ","Gợi ý cho bạn","Sponsored","Suggested for You","Reels và video ngắn"],l=['[href^="/ads/about"]','[href^="/reel/"]'],o="div[role=complementary]",E="Được tài trợ",s="h3",c="Bài viết trên Bảng tin",i=":scope>div:not(.checked)",a=["SPONSORED","ENGAGEMENT","SHOWCASE","FB_SHORTS"],d=[80],u=3e4,_=2e3,T="adSelector",S=["[aria-label=Sponsored]","a[role=link][target=_blank]"]},713:(e,t,n)=>{function r(e){const t=document.getElementsByTagName("head")[0],n=document.createElement("link");t&&(n.type="text/css",n.rel="stylesheet",n.href=e,t.appendChild(n))}n.r(t),n.d(t,{addExternalStyle:()=>r,checkContainSelectors:()=>E,getSnapshotElmByContent:()=>o,hideDOM:()=>c,observeDOM:()=>l,removeDOM:()=>s});const l=(e,t,n)=>{const r={attributes:!1,childList:!1,subtree:!1,...t},l=new MutationObserver(n);return l.observe(e,r),()=>l.disconnect()},o=e=>{const t=["b","span"];let n=null;for(let r=0;r<t.length;r++){const l=t[r];if(n&&n.snapshotLength)break;n=document.evaluate(`//${l}[contains(., '${e}')]`,document,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null)}return n&&n.snapshotLength?n.snapshotItem(0):null},E=(e,t)=>{if(!e)return!1;let n=!1;return t.forEach((t=>{((e,t)=>!!e.querySelector(t))(e,t)&&(n=!0)})),n},s=e=>{try{e.parentElement.removeChild(e)}catch(e){console.error(e)}},c=e=>{try{e.style.display="none",e.classList.add("hided")}catch(e){console.error(e)}}}},t={};function n(r){var l=t[r];if(void 0!==l)return l.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};const r=GM_setValue,l=GM_getValue,o=GM_deleteValue,E=GM_listValues,s=(e,t)=>{GM_addValueChangeListener(e,((e,n,r,l)=>t(r,l,n)))},c=(e,t,n)=>{r(e,n(l(e,t)))},i={get:l,set:r,del:o,list:E,onChange:s,update:c,val:e=>({set:r.bind(null,e),get:l.bind(null,e),del:o.bind(null,e),update:c.bind(null,e),onChange:s.bind(null,e)})};var a=n(608),d=n(713);const u={attributes:!1,childList:!0,subtree:!1},_=function(e,t){for(const t of e)"childList"===t.type&&t.addedNodes.forEach((e=>{T(e)&&(console.log("removed incoming ad"),(0,d.hideDOM)(e))}))},T=e=>{if(!e)return!1;let t=!1;const n=(e=>{const t=Object.keys(e).find((e=>e.includes("reactProp")));if(!t)return null;let n=null;try{n=e[t].children.props.children.props.children.props.children.props.children.props}catch(e){}return n})(e);if(!n)return!1;if(e.classList.add("checked"),!t){const n=e.querySelector("h4");n&&n.innerText.includes("Theo dõi")&&(t=!0)}return t},S=e=>{e?e.querySelectorAll(a.ARTICLES_SELECTOR).forEach((e=>{T(e)&&(console.log("removed remain ad"),(0,d.hideDOM)(e))})):setTimeout((()=>{const e=document.querySelectorAll(a.FEED_HEADING_SELECTOR);let t=null;for(let n of e)n.innerText==a.FEED_HEADING_CONTENT&&(t=t=n.parentElement.lastElementChild);S(t)}))},h=e=>{e?(0,d.observeDOM)(e,u,_):setTimeout((()=>{const e=document.querySelectorAll(a.FEED_HEADING_SELECTOR);let t=null;for(let n of e)n.innerText==a.FEED_HEADING_CONTENT&&(t=n.parentElement.lastElementChild);h(t)}),500)},{removeDOM:p}=n(713),{RIGHT_PANEL_SELECTOR:A,RIGHT_PANEL_ADS_HEADING_CONTENT:O}=n(608),D=()=>{(()=>{const e=document.querySelector(A);if(e){const t=e.querySelectorAll("h3");let n=null;for(const e of t)e.innerText==O&&(n=e);let r=n;if(n)for(;r&&!(r.parentElement&&r.parentElement.querySelectorAll("h3").length>1);)r=r.parentElement;r&&(console.log("Remove right panel ADs"),p(r))}})(),S()};i.set(a.STORE_KEY,a.DEFAULT_AD_SELECTOR),setInterval(D,a.INTERVAL_TIME_REMOVE_EXISTED_ADS),h()})();