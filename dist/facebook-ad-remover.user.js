// ==UserScript==
// @name        Facebook advertisements remover
// @version     1.2.2
// @author      Hung Dinh
// @description Remove advertisements on facebook web
// @homepage    https://github.com/dinhhung2910/our-userscripts#readme
// @supportURL  https://github.com/dinhhung2910/our-userscripts/pulls
// @match       https://www.facebook.com/**
// @namespace   Script
// @updateURL   https://github.com/dinhhung2910/our-userscripts/raw/main/dist/facebook-ad-remover.user.js
// @source      https://github.com/dinhhung2910/our-userscripts/blob/main/dist/facebook-ad-remover.user.js
// @grant       GM_getValue
// @grant       GM_setValue
// @grant       GM_deleteValue
// @grant       GM_listValues
// @grant       GM_notification
// @grant       GM_xmlhttpRequest
// @grant       GM_addValueChangeListener
// @grant       GM_removeValueChangeListener
// @grant       GM_log
// ==/UserScript==

(()=>{"use strict";var e={990:(e,t,o)=>{function n(e){const t=document.getElementsByTagName("head")[0],o=document.createElement("link");t&&(o.type="text/css",o.rel="stylesheet",o.href=e,t.appendChild(o))}o.r(t),o.d(t,{addExternalStyle:()=>n,observeDOM:()=>r,getSnapshotElmByContent:()=>l,checkContainSelectors:()=>s,removeDOM:()=>a,hideDOM:()=>c});const r=(e,t,o)=>{const n={attributes:!1,childList:!1,subtree:!1,...t},r=new MutationObserver(o);return r.observe(e,n),()=>r.disconnect()},l=e=>{const t=["b","span"];let o=null;for(let n=0;n<t.length;n++){const r=t[n];if(o&&o.snapshotLength)break;o=document.evaluate(`//${r}[contains(., '${e}')]`,document,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null)}return o&&o.snapshotLength?o.snapshotItem(0):null},s=(e,t)=>{if(!e)return!1;let o=!1;return t.forEach((t=>{((e,t)=>!!e.querySelector(t))(e,t)&&(o=!0)})),o},a=e=>{try{e.parentElement.removeChild(e)}catch(e){console.error(e)}},c=e=>{try{e.style.display="none",e.classList.add("hided")}catch(e){console.error(e)}}},758:(e,t,o)=>{o.r(t),o.d(t,{AD_LABELS:()=>n,RIGHT_PANEL_SELECTOR:()=>r,RIGHT_PANEL_ADS_ARIA:()=>l,FEED_SELECTOR:()=>s,ARTICLES_SELECTOR:()=>a,INTERVAL_TIME_RE_EVALUATE_ADS:()=>c,INTERVAL_TIME_REMOVE_EXISTED_ADS:()=>E,STORE_KEY:()=>d,DEFAULT_AD_SELECTOR:()=>i});const n=["Được tài trợ","Gợi ý cho bạn","Sponsored","Suggested for You"],r='[data-pagelet="RightRail"]',l=['[aria-label="Liên kết của nhà quảng cáo"]'],s='[role="feed"]',a="[data-pagelet]:not(.hided)",c=3e4,E=2e3,d="adSelector",i=["[aria-label=Sponsored]"]}},t={};function o(n){var r=t[n];if(void 0!==r)return r.exports;var l=t[n]={exports:{}};return e[n](l,l.exports,o),l.exports}o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{const e=GM_setValue,t=GM_getValue,n=GM_deleteValue,r=GM_listValues,l=(e,t)=>{GM_addValueChangeListener(e,((e,o,n,r)=>t(n,r,o)))},s=(o,n,r)=>{e(o,r(t(o,n)))},a={get:t,set:e,del:n,list:r,onChange:l,update:s,val:o=>({set:e.bind(null,o),get:t.bind(null,o),del:n.bind(null,o),update:s.bind(null,o),onChange:l.bind(null,o)})};var c=o(758),E=o(990);const d=(o=c.INTERVAL_TIME_RE_EVALUATE_ADS)=>(c.AD_LABELS.forEach((o=>{const n=(0,E.getSnapshotElmByContent)(o);if(n){const o="."+n.className.split(" ").join(".");"."!=o&&((o,n)=>{let r=t(o);Array.isArray(r)||(r=[]),r.includes(n)||r.push(n),e(o,r)})("adSelector",o),console.log(t("adSelector")),console.info("Updated ad selector")}})),t("adSelector")?setTimeout((()=>{d()}),o):setTimeout((()=>{d()}),500)),i=d,u={attributes:!1,childList:!0,subtree:!1},S=function(e,t){for(const t of e)"childList"===t.type&&t.addedNodes.forEach((e=>{_(e)&&(console.log("removed incoming ad"),(0,E.hideDOM)(e))}))},_=e=>{let t=!1;return a.get("adSelector").forEach((o=>{try{e.querySelectorAll(o).forEach((e=>{"string"==typeof e.innerText&&c.AD_LABELS.forEach((o=>{e.innerText.includes(o)&&(t=!0)}))}))}catch(e){console.warn(e,o)}})),t},h=e=>{e?e.querySelectorAll(c.ARTICLES_SELECTOR).forEach((e=>{_(e)&&(console.log("removed remain ad"),(0,E.hideDOM)(e))})):setTimeout((()=>{const e=document.querySelector(c.FEED_SELECTOR);h(e)}))},T=e=>{e?(0,E.observeDOM)(e,u,S):setTimeout((()=>{const e=document.querySelector(c.FEED_SELECTOR);T(e)}))},{checkContainSelectors:A,removeDOM:L}=o(990),{RIGHT_PANEL_SELECTOR:m,RIGHT_PANEL_ADS_ARIA:p,AD_LABELS:R}=o(758),f=()=>{(()=>{const e=document.querySelector(m);e&&setTimeout((()=>{let t=null;try{t=e.firstElementChild.firstElementChild}catch(e){}if(A(t,p))L(t),console.log("Removed right panel ads");else{let e=!1;const o=t.innerText;R.forEach((t=>{o.includes(t)&&(e=!0)})),e&&L(t)}}),0)})(),h()};a.set(c.STORE_KEY,c.DEFAULT_AD_SELECTOR),i(),setInterval(f,c.INTERVAL_TIME_REMOVE_EXISTED_ADS),T()})()})();